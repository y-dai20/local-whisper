# Local Whisper

CPU ç’°å¢ƒã§é«˜é€Ÿã«å‹•ä½œã™ã‚‹ã€å®Œå…¨ã‚ªãƒ•ãƒ©ã‚¤ãƒ³ã®æ–‡å­—èµ·ã“ã—ã‚¢ãƒ—ãƒª

## ç‰¹å¾´

- âœ… **å®Œå…¨ã‚ªãƒ•ãƒ©ã‚¤ãƒ³**: ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¢ã‚¯ã‚»ã‚¹ä¸è¦
- âš¡ **CPU æœ€é©åŒ–**: whisper.cpp ã‚’ä½¿ç”¨ã—ãŸé«˜é€Ÿå‡¦ç†
- ğŸ™ï¸ **ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ éŒ²éŸ³**: ãƒã‚¤ã‚¯å…¥åŠ›ã‹ã‚‰ç›´æ¥æ–‡å­—èµ·ã“ã—
- ğŸ‡¯ğŸ‡µ **æ—¥æœ¬èªå¯¾å¿œ**: æ—¥æœ¬èªéŸ³å£°ã®æ–‡å­—èµ·ã“ã—ã«æœ€é©åŒ–
- ğŸ–¥ï¸ **ã‚¯ãƒ­ã‚¹ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ **: Tauri ãƒ™ãƒ¼ã‚¹ã®ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—ã‚¢ãƒ—ãƒª

## ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

```
local-whisper/
â”œâ”€â”€ vendor/whisper.cpp/          # whisper.cpp submodule (ãƒ¢ãƒ‡ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ç”¨)
â”œâ”€â”€ crates/asr-core/              # whisper-rsã®ãƒ©ãƒƒãƒ‘ãƒ¼
â””â”€â”€ apps/desktop/                 # Tauri + React frontend
    â”œâ”€â”€ src/                      # React UI
    â””â”€â”€ src-tauri/                # Rust backend
```

## ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

### 1. å¿…è¦ãªç’°å¢ƒ

- Rust (1.70+)
- Node.js (18+)
- pnpm
- C++ compiler (whisper.cpp ã®ãƒ“ãƒ«ãƒ‰ã«å¿…è¦)

### 2. ãƒªãƒã‚¸ãƒˆãƒªã®ã‚¯ãƒ­ãƒ¼ãƒ³

```bash
git clone <repository-url>
cd local-whisper
git submodule update --init --recursive
```

### 3. Whisper ãƒ¢ãƒ‡ãƒ«ã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰

```bash
cd vendor/whisper.cpp/models
bash download-ggml-model.sh base
# ã¾ãŸã¯ä»–ã®ãƒ¢ãƒ‡ãƒ«: tiny, small, medium, large
```

åˆ©ç”¨å¯èƒ½ãªãƒ¢ãƒ‡ãƒ«:

- `tiny`: æœ€é€Ÿã€ç²¾åº¦ä½
- `base`: ãƒãƒ©ãƒ³ã‚¹å‹ï¼ˆæ¨å¥¨ï¼‰
- `small`: é«˜ç²¾åº¦
- `medium`: ã‚ˆã‚Šé«˜ç²¾åº¦
- `large`: æœ€é«˜ç²¾åº¦ã€æœ€ã‚‚é…ã„

### 4. ä¾å­˜é–¢ä¿‚ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```bash
cd apps/desktop
pnpm install
```

### 5. ã‚¢ãƒ—ãƒªã®èµ·å‹•

```bash
cd apps/desktop
pnpm tauri dev
```

## ä½¿ã„æ–¹

1. ã‚¢ãƒ—ãƒªã‚’èµ·å‹•
2. ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸãƒ¢ãƒ‡ãƒ«ã®ãƒ‘ã‚¹ã‚’å…¥åŠ›ï¼ˆä¾‹: `/path/to/local-whisper/vendor/whisper.cpp/models/ggml-base.bin`ï¼‰
3. ã€ŒåˆæœŸåŒ–ã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯
4. ã€ŒéŒ²éŸ³é–‹å§‹ã€ãƒœã‚¿ãƒ³ã§ãƒã‚¤ã‚¯éŒ²éŸ³ã‚’é–‹å§‹
5. ã€ŒéŒ²éŸ³åœæ­¢ã€ãƒœã‚¿ãƒ³ã§éŒ²éŸ³ã‚’åœæ­¢ã—ã€æ–‡å­—èµ·ã“ã—ã‚’å®Ÿè¡Œ
6. çµæœãŒãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§è¡¨ç¤ºã•ã‚Œã¾ã™

## æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

### Backend

- **Rust**: ã‚·ã‚¹ãƒ†ãƒ ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°è¨€èª
- **Tauri**: ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—ã‚¢ãƒ—ãƒªãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯
- **whisper.cpp**: CPU æœ€é©åŒ–ã•ã‚ŒãŸ Whisper å®Ÿè£…
- **bindgen**: C/C++ FFI bindings ç”Ÿæˆ

### Frontend

- **React**: UI ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯
- **TypeScript**: å‹å®‰å…¨ãª JavaScript
- **Vite**: é«˜é€Ÿãƒ“ãƒ«ãƒ‰ãƒ„ãƒ¼ãƒ«
- **Web Audio API**: ãƒã‚¤ã‚¯å…¥åŠ›å‡¦ç†

## é–‹ç™º

### ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹é€ 

- `crates/asr-core`: whisper-rs ã® Safe Rust ãƒ©ãƒƒãƒ‘ãƒ¼

  - `WhisperContext`: ãƒ¢ãƒ‡ãƒ«ã®åˆæœŸåŒ–ã¨ç®¡ç†
  - `transcribe()`: éŸ³å£°ãƒ‡ãƒ¼ã‚¿ã®æ–‡å­—èµ·ã“ã—
  - `transcribe_with_callback()`: ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°æ–‡å­—èµ·ã“ã—
  - whisper-rs crate ã‚’ä½¿ç”¨ã—ã¦ç°¡æ½”ã«å®Ÿè£…

- `apps/desktop/src-tauri`: Tauri ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰
  - `initialize_whisper`: ãƒ¢ãƒ‡ãƒ«ã®åˆæœŸåŒ–
  - `transcribe_audio`: éŸ³å£°ãƒ‡ãƒ¼ã‚¿ã®æ–‡å­—èµ·ã“ã—
  - `transcribe_audio_stream`: ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°æ–‡å­—èµ·ã“ã—
  - asr-core ã‚’å‘¼ã³å‡ºã—ã¦ UI ã«ã‚¤ãƒ™ãƒ³ãƒˆã‚’ emit

### ãƒ“ãƒ«ãƒ‰

```bash
cd apps/desktop
pnpm tauri build
```

## ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–

whisper.cpp ã¯ä»¥ä¸‹ã® CPU æœ€é©åŒ–ã‚’ä½¿ç”¨:

- AVX/AVX2 å‘½ä»¤ã‚»ãƒƒãƒˆ
- FMA (Fused Multiply-Add)
- F16C (Half-precision floating-point)
- ãƒãƒ«ãƒã‚¹ãƒ¬ãƒƒãƒ‰å‡¦ç†

## ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ãƒ“ãƒ«ãƒ‰ã‚¨ãƒ©ãƒ¼

**å•é¡Œ**: `bindgen`ã®ã‚¨ãƒ©ãƒ¼

```bash
# Clang/LLVMã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
# macOS
brew install llvm

# Ubuntu/Debian
sudo apt-get install libclang-dev
```

**å•é¡Œ**: whisper.cpp ã®ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚¨ãƒ©ãƒ¼

```bash
# C++ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã‚’ç¢ºèª
g++ --version
clang++ --version
```

### å®Ÿè¡Œæ™‚ã‚¨ãƒ©ãƒ¼

**å•é¡Œ**: ãƒ¢ãƒ‡ãƒ«ã®èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼

- ãƒ¢ãƒ‡ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¹ãŒæ­£ã—ã„ã‹ç¢ºèª
- ãƒ¢ãƒ‡ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ãŒå®Œå…¨ã«ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª

**å•é¡Œ**: ãƒã‚¤ã‚¯ã‚¢ã‚¯ã‚»ã‚¹ã‚¨ãƒ©ãƒ¼

- ã‚·ã‚¹ãƒ†ãƒ ã®ãƒã‚¤ã‚¯æ¨©é™ã‚’ç¢ºèª
- ä»–ã®ã‚¢ãƒ—ãƒªãŒãƒã‚¤ã‚¯ã‚’ä½¿ç”¨ã—ã¦ã„ãªã„ã‹ç¢ºèª

## ãƒ©ã‚¤ã‚»ãƒ³ã‚¹

ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯ MIT ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã®ä¸‹ã§å…¬é–‹ã•ã‚Œã¦ã„ã¾ã™ã€‚

## è¬è¾

- [whisper.cpp](https://github.com/ggerganov/whisper.cpp) - CPU æœ€é©åŒ–ã•ã‚ŒãŸ Whisper å®Ÿè£…
- [OpenAI Whisper](https://github.com/openai/whisper) - å…ƒã® Whisper ãƒ¢ãƒ‡ãƒ«
- [Tauri](https://tauri.app/) - ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—ã‚¢ãƒ—ãƒªãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯
